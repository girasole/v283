---
title: Safe, Out-of-Distribution-Adaptive MPC with Conformalized Neural Network Ensembles
abstract: We present SODA-MPC, a Safe, Out-of-Distribution-Adaptive Model Predictive
  Control algorithm, which uses an ensemble of learned models for prediction, with
  a runtime monitor to flag unreliable out-of-distribution (OOD) predictions. When
  an OOD situation is detected, SODA-MPC triggers a safe fallback control strategy
  based on reachability, yielding a control framework that achieves the high performance
  of learning-based models while preserving the safety of reachability-based control.
  We demonstrate the method in the context of an autonomous vehicle, driving among
  dynamic pedestrians, where SODA-MPC uses a neural network ensemble for pedestrian
  prediction. We use the maximum singular value of the empirical covariance among
  the ensemble as the OOD signal for the runtime monitor. We calibrate this signal
  using conformal prediction to derive an OOD detector with probabilistic guarantees
  on the false-positive rate, given a user-specified confidence level. During in-distribution
  operation, the MPC controller avoids collisions with a pedestrian based on the trajectory
  predicted by the mean of the ensemble. When OOD conditions are detected, the MPC
  switches to a reachability-based controller to avoid collisions with the reachable
  set of the pedestrian assuming a maximum pedestrian speed, to guarantee safety under
  the worst-case actions of the pedestrian. We verify SODA-MPC in extensive autonomous
  driving simulations in a pedestrian-crossing scenario. Our model ensemble is trained
  and calibrated with real pedestrian data, showing that our OOD detector obtains
  the desired accuracy rate within a theoretically-predicted range. We empirically
  show improved safety and improved task completion compared with two state-of-the-art
  MPC methods that also use conformal prediction, but without OOD adaptation. Further,
  we demonstrate the effectiveness of our method with the large-scale multi-agent
  predictor Trajectron++, using large-scale traffic data from the NuScenes dataset
  for training and calibration.
layout: inproceedings
series: Proceedings of Machine Learning Research
publisher: PMLR
issn: 2640-3498
id: contreras25a
month: 0
tex_title: Safe, Out-of-Distribution-Adaptive MPC with Conformalized Neural Network
  Ensembles
firstpage: 194
lastpage: 207
page: 194-207
order: 194
cycles: false
bibtex_author: Contreras, Jose Leopoldo and Shorinwa, Ola and Schwager, Mac
author:
- given: Jose Leopoldo
  family: Contreras
- given: Ola
  family: Shorinwa
- given: Mac
  family: Schwager
date: 2025-05-22
address:
container-title: Proceedings of the 7th Annual Learning for Dynamics \& Control Conference
volume: '283'
genre: inproceedings
issued:
  date-parts:
  - 2025
  - 5
  - 22
pdf: https://raw.githubusercontent.com/mlresearch/v283/main/assets/contreras25a/contreras25a.pdf
extras: []
# Format based on Martin Fenner's citeproc: https://blog.front-matter.io/posts/citeproc-yaml-for-bibliographies/
---
